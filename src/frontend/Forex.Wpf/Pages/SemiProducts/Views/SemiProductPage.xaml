<Page
    x:Class="Forex.Wpf.Pages.SemiProducts.Views.SemiProductPage"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:Forex.Wpf.Resources.UserControls"
    xmlns:converters="clr-namespace:Forex.Wpf.Resources.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:vm="clr-namespace:Forex.Wpf.Pages.SemiProducts.ViewModels"
    x:Name="RootPage"
    Title="Kirim qilish"
    d:DesignHeight="580"
    d:DesignWidth="810"
    mc:Ignorable="d">

    <!--  ======= STYLES =======  -->
    <Page.Resources>
        <Style x:Key="TransparentCellStyle" TargetType="DataGridCell">
            <Setter Property="Padding" Value="0" />
            <Setter Property="FontSize" Value="15" />
            <Setter Property="Margin" Value="0" />
            <Setter Property="Background" Value="Transparent" />
            <Setter Property="Foreground" Value="{StaticResource PrimaryTextColor}" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="FocusVisualStyle" Value="{x:Null}" />
            <Style.Resources>
                <Style TargetType="TextBox">
                    <Setter Property="HorizontalContentAlignment" Value="Center" />
                    <Setter Property="VerticalContentAlignment" Value="Center" />
                    <Setter Property="BorderThickness" Value="0" />
                    <Setter Property="Background" Value="Transparent" />
                    <Setter Property="FontSize" Value="{Binding FontSize, RelativeSource={RelativeSource AncestorType=DataGridCell}}" />
                </Style>
            </Style.Resources>
        </Style>

        <!--  Centered Text  -->
        <Style x:Key="CenteredTextBlockStyle" TargetType="TextBlock">
            <Setter Property="HorizontalAlignment" Value="Center" />
            <Setter Property="VerticalAlignment" Value="Center" />
        </Style>

        <Style x:Key="CenteredComboBoxStyle" TargetType="ComboBox">
            <Setter Property="HorizontalContentAlignment" Value="Center" />
            <Setter Property="VerticalContentAlignment" Value="Center" />
            <Setter Property="ItemsSource" Value="{Binding DataContext.AvailableUnitMeasures, RelativeSource={RelativeSource AncestorType=Page}}" />
        </Style>

        <!--  Delete Button Style  -->
        <Style x:Key="DeleteButtonStyle" TargetType="Button">
            <Setter Property="Background" Value="#FF5252" />
            <Setter Property="Foreground" Value="White" />
            <Setter Property="BorderThickness" Value="0" />
            <Setter Property="Padding" Value="8,4" />
            <Setter Property="Cursor" Value="Hand" />
            <Setter Property="FontWeight" Value="Bold" />
            <Setter Property="FontSize" Value="14" />
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border
                            Padding="{TemplateBinding Padding}"
                            Background="{TemplateBinding Background}"
                            CornerRadius="3">
                            <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center" />
                        </Border>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#E53935" />
                </Trigger>
            </Style.Triggers>
        </Style>

    </Page.Resources>


    <!--  ======= MAIN CONTAINER =======  -->
    <Border Background="{StaticResource PrimaryBackground}" CornerRadius="4">
        <Grid Margin="10">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto" />
                <RowDefinition Height="80" />
                <RowDefinition Height="*" />
                <RowDefinition Height="Auto" />
            </Grid.RowDefinitions>

            <Button
                x:Name="btnBack"
                HorizontalAlignment="Right"
                md:ButtonAssist.CornerRadius="5"
                Background="{DynamicResource OtherBackground}"
                BorderThickness="0"
                Click="BtnBack_Click"
                Content="🔙 Orqaga"
                ToolTip="Orqaga" />


            <Grid Grid.Row="1" Margin="10">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <TextBlock
                    VerticalAlignment="Center"
                    FontSize="14"
                    Text="Invoice raqami:" />
                <Border
                    Grid.Column="1"
                    Width="120"
                    Margin="5,1"
                    Background="White"
                    BorderBrush="Black"
                    BorderThickness="1"
                    CornerRadius="4">
                    <TextBox
                        Padding="4,0"
                        Background="Transparent"
                        BorderThickness="0"
                        FontSize="14"
                        Text="{Binding Invoice.Number}" />
                </Border>


                <TextBlock
                    Grid.Row="1"
                    VerticalAlignment="Center"
                    FontSize="14"
                    Text="Sana:" />
                <controls:UserCalendar
                    x:Name="beginDate"
                    Grid.Row="1"
                    Grid.Column="1"
                    Width="120"
                    Height="27"
                    VerticalAlignment="Center"
                    FontSize="14"
                    SelectedDate="{Binding Invoice.Date, Mode=TwoWay}" />

                <TextBlock
                    Grid.Column="2"
                    VerticalAlignment="Center"
                    FontSize="14"
                    Text="Tan narxi:" />
                <Border
                    Grid.Column="3"
                    Width="120"
                    Margin="5,1"
                    Background="White"
                    BorderBrush="Black"
                    BorderThickness="1"
                    CornerRadius="4">
                    <TextBlock
                        Padding="4,0"
                        HorizontalAlignment="Right"
                        VerticalAlignment="Center"
                        Background="Transparent"
                        FontSize="14"
                        Text="{Binding Invoice.CostPrice, StringFormat={}{0:N0}}" />
                </Border>

                <TextBlock
                    Grid.Row="1"
                    Grid.Column="2"
                    VerticalAlignment="Center"
                    FontSize="14"
                    Text="*Yo'l xarajati:" />
                <Border
                    Grid.Row="1"
                    Grid.Column="3"
                    Width="120"
                    Margin="5,1"
                    Background="White"
                    BorderBrush="Black"
                    BorderThickness="1"
                    CornerRadius="4">
                    <TextBox
                        Padding="4,0"
                        VerticalAlignment="Center"
                        HorizontalContentAlignment="Right"
                        Background="Transparent"
                        BorderThickness="0"
                        FontSize="14"
                        Text="{Binding Invoice.CostDelivery, StringFormat={}{0:N0}}" />
                </Border>

                <TextBlock
                    Grid.Column="4"
                    VerticalAlignment="Center"
                    FontSize="14"
                    Text="Ta'minotchi:" />
                <Border
                    Grid.Column="5"
                    Width="150"
                    Margin="5,0"
                    VerticalAlignment="Center"
                    Background="White"
                    BorderBrush="Black"
                    BorderThickness="1"
                    CornerRadius="4">
                    <ComboBox
                        x:Name="cbxSupplier"
                        Height="28"
                        Padding="4,0"
                        Background="Transparent"
                        BorderThickness="0"
                        DisplayMemberPath="Name"
                        FontSize="14"
                        ItemsSource="{Binding AvailableSuppliers}"
                        SelectedItem="{Binding Invoice.Supplier}" />
                </Border>

                <TextBlock
                    Grid.Row="1"
                    Grid.Column="4"
                    VerticalAlignment="Center"
                    FontSize="14"
                    Text="Vositachi orqali:" />

                <ToggleButton
                    Grid.Row="1"
                    Grid.Column="5"
                    Margin="5"
                    VerticalAlignment="Center"
                    FontSize="14"
                    IsChecked="{Binding Invoice.ViaMiddleman, Mode=TwoWay}" />

                <TextBlock
                    Grid.Column="6"
                    VerticalAlignment="Center"
                    FontSize="14"
                    Text="Vositachi:"
                    Visibility="{Binding Invoice.ViaMiddleman, Converter={StaticResource BoolToVisibilityConverter}}" />

                <Border
                    Grid.Column="7"
                    Width="150"
                    Margin="5,1"
                    VerticalAlignment="Center"
                    Background="White"
                    BorderBrush="Black"
                    BorderThickness="1"
                    CornerRadius="4"
                    Visibility="{Binding Invoice.ViaMiddleman, Converter={StaticResource BoolToVisibilityConverter}}">
                    <ComboBox
                        x:Name="cbxBroker"
                        Height="28"
                        Padding="4,2"
                        Background="Transparent"
                        BorderThickness="0"
                        DisplayMemberPath="Name"
                        FontSize="14"
                        ItemsSource="{Binding AvailableAgents}"
                        SelectedItem="{Binding Invoice.Agent}" />
                </Border>

                <TextBlock
                    Grid.Row="1"
                    Grid.Column="6"
                    VerticalAlignment="Center"
                    FontSize="14"
                    Text="*Kontiner soni:"
                    Visibility="{Binding Invoice.ViaMiddleman, Converter={StaticResource BoolToVisibilityConverter}}" />

                <Border
                    Grid.Row="1"
                    Grid.Column="7"
                    Margin="5,1"
                    Background="White"
                    BorderBrush="Black"
                    BorderThickness="1"
                    CornerRadius="4"
                    Visibility="{Binding Invoice.ViaMiddleman, Converter={StaticResource BoolToVisibilityConverter}}">
                    <TextBox
                        Height="28"
                        Padding="4,0"
                        VerticalContentAlignment="Center"
                        Background="Transparent"
                        BorderThickness="0"
                        FontSize="14"
                        Text="{Binding Invoice.ContainerCount}" />
                </Border>

                <TextBlock
                    Grid.Column="8"
                    VerticalAlignment="Center"
                    FontSize="14"
                    Text="*Dona kon. u-n to'lov:"
                    Visibility="{Binding Invoice.ViaMiddleman, Converter={StaticResource BoolToVisibilityConverter}}" />

                <Border
                    Grid.Column="9"
                    Margin="5,1"
                    Background="White"
                    BorderBrush="Black"
                    BorderThickness="1"
                    CornerRadius="4"
                    Visibility="{Binding Invoice.ViaMiddleman, Converter={StaticResource BoolToVisibilityConverter}}">
                    <TextBox
                        Padding="2,0"
                        VerticalAlignment="Center"
                        HorizontalContentAlignment="Right"
                        Background="Transparent"
                        BorderThickness="0"
                        FontSize="14"
                        Text="{Binding Invoice.PricePerUnitContainer, StringFormat=C}"
                        ToolTip="Bir dona kontiner uchun qilinadigan to'lov summasi" />
                </Border>

                <TextBlock
                    Grid.Row="1"
                    Grid.Column="8"
                    VerticalAlignment="Center"
                    FontSize="14"
                    Text="*Kursi:"
                    Visibility="{Binding Invoice.ViaMiddleman, Converter={StaticResource BoolToVisibilityConverter}}" />

                <Border
                    Grid.Row="1"
                    Grid.Column="9"
                    Width="100"
                    Margin="5,1"
                    Background="White"
                    BorderBrush="Black"
                    BorderThickness="1"
                    CornerRadius="4"
                    Visibility="{Binding Invoice.ViaMiddleman, Converter={StaticResource BoolToVisibilityConverter}}">
                    <TextBox
                        Padding="2,0"
                        VerticalAlignment="Center"
                        HorizontalContentAlignment="Right"
                        Background="Transparent"
                        BorderThickness="0"
                        FontSize="14"
                        Text="{Binding Invoice.Currency.ExchangeRate, StringFormat={}{0:N0} so\'m}" />
                </Border>

            </Grid>

            <!--  ==== TABLE WRAPPER ====  -->
            <Border
                Grid.Row="2"
                Background="#EEE"
                BorderBrush="Gray"
                BorderThickness="1"
                CornerRadius="4">

                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto" />
                        <!--  HEADER  -->
                        <RowDefinition Height="*" />
                        <!--  BODY  -->
                        <RowDefinition Height="Auto" />
                        <!--  FOOTER  -->
                    </Grid.RowDefinitions>

                    <!--  ===== HEADER =====  -->
                    <Border
                        Grid.Row="0"
                        Padding="2"
                        Background="#EEE"
                        BorderBrush="Gray"
                        BorderThickness="0,0,0,1"
                        CornerRadius="4 4 0 0">
                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="55" />
                                <ColumnDefinition Width="150" />
                                <ColumnDefinition Width="100" />
                                <ColumnDefinition Width="100" />
                                <ColumnDefinition Width="*" />
                                <ColumnDefinition Width="50" />
                            </Grid.ColumnDefinitions>

                            <TextBlock
                                HorizontalAlignment="Center"
                                FontSize="16"
                                FontWeight="Bold"
                                Text="#" />
                            <TextBlock
                                Grid.Column="1"
                                HorizontalAlignment="Center"
                                FontSize="16"
                                FontWeight="Bold"
                                Text="Rasm" />
                            <TextBlock
                                Grid.Column="2"
                                HorizontalAlignment="Center"
                                FontSize="16"
                                FontWeight="Bold"
                                Text="Kodi" />
                            <TextBlock
                                Grid.Column="3"
                                HorizontalAlignment="Center"
                                FontSize="16"
                                FontWeight="Bold"
                                Text="Nomi" />

                            <Grid Grid.Column="4">
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="100" />
                                    <ColumnDefinition Width="*" />
                                </Grid.ColumnDefinitions>

                                <TextBlock
                                    HorizontalAlignment="Center"
                                    FontSize="16"
                                    FontWeight="Bold"
                                    Text="O'lchami"
                                    ToolTip="24-29 yoki 30-35 kabi o'lchalmar" />
                                <Grid Grid.Column="1">
                                    <Grid.ColumnDefinitions>
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="*" />
                                        <ColumnDefinition Width="40" />
                                    </Grid.ColumnDefinitions>
                                    <TextBlock
                                        HorizontalAlignment="Center"
                                        FontSize="16"
                                        FontWeight="Bold"
                                        Text="Soni"
                                        ToolTip="Olib kelingan shu turdagi yarim tayyor maxsulot soni" />
                                    <TextBlock
                                        Grid.Column="1"
                                        HorizontalAlignment="Center"
                                        FontSize="16"
                                        FontWeight="Bold"
                                        Text="O'lchov birligi"
                                        ToolTip="Misol uchun: dona, kg..." />
                                    <TextBlock
                                        Grid.Column="2"
                                        HorizontalAlignment="Center"
                                        FontSize="16"
                                        FontWeight="Bold"
                                        Text="Bir maxsulot narxi"
                                        ToolTip="Kelgan maxsulotlarning bir donasini tan narxi" />
                                    <TextBlock
                                        Grid.Column="3"
                                        HorizontalAlignment="Center"
                                        FontSize="16"
                                        FontWeight="Bold"
                                        Text="Jami summa"
                                        ToolTip="Keltirilgan maxsulotlarning jami narxi" />
                                </Grid>
                            </Grid>
                            <TextBlock
                                Grid.Column="5"
                                HorizontalAlignment="Center"
                                FontSize="16"
                                FontWeight="Bold"
                                Text="⚙" />
                        </Grid>
                    </Border>

                    <!--  ===== BODY =====  -->
                    <Border
                        Grid.Row="1"
                        BorderBrush="Gray"
                        BorderThickness="0,1,0,1"
                        CornerRadius="0">
                        <ScrollViewer
                            PanningMode="VerticalOnly"
                            PreviewMouseWheel="ScrollViewer_PreviewMouseWheel"
                            VerticalScrollBarVisibility="Auto">
                            <DataGrid
                                Margin="0,2"
                                AlternationCount="100"
                                AutoGenerateColumns="False"
                                CanUserAddRows="True"
                                CellStyle="{StaticResource TransparentCellStyle}"
                                GridLinesVisibility="All"
                                HeadersVisibility="None"
                                HorizontalGridLinesBrush="Black"
                                ItemsSource="{Binding Products}"
                                KeyboardNavigation.TabNavigation="Continue"
                                VerticalGridLinesBrush="LightGray">
                                <DataGrid.Columns>
                                    <DataGridTemplateColumn Width="55">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <TextBlock
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    Text="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=(ItemsControl.AlternationIndex), Converter={StaticResource RowNumber}}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn>
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button
                                                    Width="150"
                                                    Height="150"
                                                    Command="{Binding SelectImageCommand}"
                                                    KeyboardNavigation.IsTabStop="False">
                                                    <Button.Background>
                                                        <ImageBrush ImageSource="{Binding Image, Converter={StaticResource ImageFallbackConverter}}" Stretch="UniformToFill" />
                                                    </Button.Background>
                                                </Button>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTextColumn
                                        Width="100"
                                        Binding="{Binding Code, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        ElementStyle="{StaticResource CenteredTextBlockStyle}"
                                        Header="Kodi" />

                                    <DataGridTextColumn
                                        Width="100"
                                        Binding="{Binding Name, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                        ElementStyle="{StaticResource CenteredTextBlockStyle}"
                                        Header="Nomi" />

                                    <DataGridTemplateColumn Width="*">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <DataGrid
                                                    AutoGenerateColumns="False"
                                                    CanUserAddRows="True"
                                                    CellStyle="{StaticResource TransparentCellStyle}"
                                                    GridLinesVisibility="All"
                                                    HeadersVisibility="None"
                                                    HorizontalGridLinesBrush="Gray"
                                                    ItemsSource="{Binding ProductTypes}"
                                                    KeyboardNavigation.TabNavigation="Continue"
                                                    VerticalGridLinesBrush="LightGray">
                                                    <DataGrid.Columns>

                                                        <DataGridTextColumn
                                                            Width="100"
                                                            Binding="{Binding Type, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                                            ElementStyle="{StaticResource CenteredTextBlockStyle}"
                                                            Header="Turi" />

                                                        <DataGridTemplateColumn Width="*">
                                                            <DataGridTemplateColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <DataGrid
                                                                        AutoGenerateColumns="False"
                                                                        CanUserAddRows="True"
                                                                        CellStyle="{StaticResource TransparentCellStyle}"
                                                                        GridLinesVisibility="All"
                                                                        HeadersVisibility="None"
                                                                        ItemsSource="{Binding ProductTypeItems}"
                                                                        KeyboardNavigation.TabNavigation="Continue">
                                                                        <DataGrid.Columns>
                                                                            <DataGridTextColumn
                                                                                Width="*"
                                                                                Binding="{Binding SemiProduct.Quantity, UpdateSourceTrigger=PropertyChanged}"
                                                                                ElementStyle="{StaticResource CenteredTextBlockStyle}" />

                                                                            <DataGridComboBoxColumn
                                                                                Width="*"
                                                                                DisplayMemberPath="Name"
                                                                                EditingElementStyle="{StaticResource CenteredComboBoxStyle}"
                                                                                ElementStyle="{StaticResource CenteredComboBoxStyle}"
                                                                                SelectedItemBinding="{Binding SemiProduct.UnitMeasure, UpdateSourceTrigger=PropertyChanged}" />

                                                                            <DataGridTextColumn
                                                                                Width="*"
                                                                                Binding="{Binding SemiProduct.CostPrice, StringFormat={}{0:N2}, UpdateSourceTrigger=PropertyChanged}"
                                                                                ElementStyle="{StaticResource CenteredTextBlockStyle}" />
                                                                            <DataGridTextColumn
                                                                                Width="*"
                                                                                Binding="{Binding SemiProduct.TotalAmount, StringFormat={}{0:N2}, UpdateSourceTrigger=PropertyChanged}"
                                                                                ElementStyle="{StaticResource CenteredTextBlockStyle}"
                                                                                IsReadOnly="True" />
                                                                            <DataGridTemplateColumn Width="30">
                                                                                <DataGridTemplateColumn.CellTemplate>
                                                                                    <DataTemplate>
                                                                                        <Button
                                                                                            Click="DeleteProductTypeItem_Click"
                                                                                            Content="−"
                                                                                            KeyboardNavigation.IsTabStop="False"
                                                                                            Style="{StaticResource DeleteButtonStyle}"
                                                                                            Tag="{Binding}"
                                                                                            ToolTip="O'chirish"
                                                                                            Visibility="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=Item, Converter={StaticResource IsNotNewRowConverter}}" />
                                                                                    </DataTemplate>
                                                                                </DataGridTemplateColumn.CellTemplate>
                                                                            </DataGridTemplateColumn>
                                                                        </DataGrid.Columns>
                                                                    </DataGrid>
                                                                </DataTemplate>
                                                            </DataGridTemplateColumn.CellTemplate>
                                                        </DataGridTemplateColumn>

                                                        <DataGridTemplateColumn Width="35">
                                                            <DataGridTemplateColumn.CellTemplate>
                                                                <DataTemplate>
                                                                    <Button
                                                                        Click="DeleteProductType_Click"
                                                                        Content="−"
                                                                        KeyboardNavigation.IsTabStop="False"
                                                                        Style="{StaticResource DeleteButtonStyle}"
                                                                        Tag="{Binding}"
                                                                        ToolTip="O'chirish"
                                                                        Visibility="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=Item, Converter={StaticResource IsNotNewRowConverter}}" />
                                                                </DataTemplate>
                                                            </DataGridTemplateColumn.CellTemplate>
                                                        </DataGridTemplateColumn>
                                                    </DataGrid.Columns>
                                                </DataGrid>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>

                                    <DataGridTemplateColumn Width="40">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button
                                                    Click="DeleteProduct_Click"
                                                    Content="−"
                                                    KeyboardNavigation.IsTabStop="False"
                                                    Style="{StaticResource DeleteButtonStyle}"
                                                    Tag="{Binding}"
                                                    ToolTip="O'chirish"
                                                    Visibility="{Binding RelativeSource={RelativeSource AncestorType=DataGridRow}, Path=Item, Converter={StaticResource IsNotNewRowConverter}}" />
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </ScrollViewer>
                    </Border>

                    <!--  ===== FOOTER =====  -->
                    <Border
                        Grid.Row="2"
                        BorderBrush="Gray"
                        BorderThickness="0,1,0,0"
                        CornerRadius="0 0 4 4">
                        <StackPanel
                            Margin="0,5"
                            HorizontalAlignment="Right"
                            Orientation="Horizontal">
                            <TextBlock
                                FontSize="16"
                                FontWeight="Bold"
                                Text="Jami: " />
                            <TextBlock
                                VerticalAlignment="Center"
                                FontSize="14"
                                FontWeight="Bold"
                                Text="{Binding Invoice.TotalAmount, StringFormat={}{0:N0}}" />
                            <TextBlock
                                Margin="10,0,20,0"
                                FontSize="16"
                                FontWeight="Bold"
                                Text="UZS" />
                        </StackPanel>
                    </Border>
                </Grid>
            </Border>

            <!--  ===== SUBMIT BUTTON =====  -->
            <StackPanel
                Grid.Row="3"
                Margin="0,10,0,0"
                HorizontalAlignment="Right"
                Orientation="Horizontal">
                <Button
                    x:Name="submitButton"
                    md:ElevationAssist.Elevation="Dp24"
                    Background="{StaticResource SuccessButtonBackground}"
                    BorderBrush="{StaticResource SuccessButtonBorder}"
                    Command="{Binding SubmitCommand}"
                    Content="Yuborish"
                    Foreground="{StaticResource SuccessButtonForeground}"
                    IsEnabled="{Binding IsLoading, Converter={StaticResource InverseBoolToBoolConverter}}" />
            </StackPanel>
        </Grid>
    </Border>
</Page>