<UserControl
    x:Class="Forex.Wpf.Pages.Reports.ViewModels.SalesHistoryReportView"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:controls="clr-namespace:Forex.Wpf.Resources.UserControls"
    xmlns:md="http://materialdesigninxaml.net/winfx/xaml/themes"
    xmlns:vm="clr-namespace:Forex.Wpf.Pages.Reports.ViewModels">

    <Grid Margin="12" Background="White">
        <Grid.RowDefinitions>
            <RowDefinition Height="90" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>


        <!--  Filter panel — SEN HOZIRGI DIZAYNING TO‘LIQ!  -->
        <Grid Grid.Row="0" Margin="10,5">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="Auto" />
                <ColumnDefinition Width="*" />
            </Grid.ColumnDefinitions>

            <!--  Mijoz + Sana  -->
            <Grid Grid.Column="0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <TextBlock
                    Grid.Row="0"
                    Grid.Column="0"
                    Margin="5,0"
                    VerticalAlignment="Center"
                    FontSize="13"
                    Text="Mijoz" />
                <Border
                    Grid.Row="0"
                    Grid.Column="1"
                    Height="30"
                    BorderBrush="#CCCCCC"
                    BorderThickness="2"
                    CornerRadius="4">
                    <ComboBox x:Name="cbxCustomer"
                        Padding="3"
                        BorderThickness="0"
                        DisplayMemberPath="Name"
                        FontSize="14"
                        IsEditable="True"
                        ItemsSource="{Binding AvailableCustomers}"
                        SelectedItem="{Binding SelectedCustomer, Mode=TwoWay}" />
                </Border>

                <TextBlock
                    Grid.Row="1"
                    Grid.Column="0"
                    Margin="5,0"
                    VerticalAlignment="Center"
                    FontSize="13"
                    Text="Xisobot davri" />
                <Grid Grid.Row="1" Grid.Column="1">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="*" />
                        <ColumnDefinition Width="Auto" />
                        <ColumnDefinition Width="Auto" />
                    </Grid.ColumnDefinitions>
                    <controls:UserCalendar x:Name="dateBegin"
                        Grid.Column="0"
                        Width="110"
                        Height="30"
                        SelectedDate="{Binding BeginDate, Mode=TwoWay}" />
                    <TextBlock
                        Grid.Column="1"
                        Margin="2,0"
                        VerticalAlignment="Center"
                        Text="dan" />
					<controls:UserCalendar x:Name="dateEnd"
                        Grid.Column="2"
                        Width="110"
                        Height="30"
                        SelectedDate="{Binding EndDate, Mode=TwoWay}" />
                    <TextBlock
                        Grid.Column="3"
                        Margin="2,0,0,0"
                        VerticalAlignment="Center"
                        Text="gacha" />
                    <Button x:Name="btnReload"
                        Grid.Column="4"
                        Width="36"
                        Height="30"
                        Margin="3,0,0,0"
                        Padding="0"
                        HorizontalContentAlignment="Center"
                        VerticalContentAlignment="Center"
                        Background="CadetBlue"
                        BorderThickness="0"
                        Command="{Binding FilterCommand}"
                        Foreground="White"
                        ToolTip="Filter">

                        <Grid HorizontalAlignment="Center" VerticalAlignment="Center">
                            <Viewbox Width="18" Height="18">
                                <Path
                                    Data="M3,5h18v2H3V5z M6,11h12v2H6v-2z M10,17h4v2h-4v-2z"
                                    Fill="White"
                                    Stretch="Uniform" />
                            </Viewbox>
                        </Grid>

                    </Button>

                </Grid>
            </Grid>

            <!--  Kodi + Nomi  -->
            <Grid Grid.Column="1" Margin="20,0,0,0">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto" />
                    <ColumnDefinition Width="*" />
                </Grid.ColumnDefinitions>
                <Grid.RowDefinitions>
                    <RowDefinition Height="*" />
                    <RowDefinition Height="*" />
                </Grid.RowDefinitions>

                <TextBlock
                    Grid.Row="0"
                    Grid.Column="0"
                    Margin="15,0,3,0"
                    VerticalAlignment="Center"
                    FontSize="13"
                    Text="Kodi" />
                <Border
                    Grid.Row="0"
                    Grid.Column="1"
                    Height="30"
                    BorderBrush="#CCCCCC"
                    BorderThickness="2"
                    CornerRadius="4">
                    <ComboBox x:Name="cbxProductCode"
                        Width="180"
                        Padding="3"
                        BorderThickness="0"
                        DisplayMemberPath="Code"
                        IsEditable="True"
                        ItemsSource="{Binding AvailableProducts}"
                        SelectedItem="{Binding SelectedCode}" />
                </Border>

                <TextBlock
                    Grid.Row="1"
                    Grid.Column="0"
                    Margin="15,0"
                    VerticalAlignment="Center"
                    FontSize="13"
                    Text="Nomi" />
                <Border
                    Grid.Row="1"
                    Grid.Column="1"
                    Height="30"
                    BorderBrush="#CCCCCC"
                    BorderThickness="2"
                    CornerRadius="4">
                    <ComboBox x:Name="cbxProductName"
                        Width="180"
                        Padding="3"
                        BorderThickness="0"
                        DisplayMemberPath="Name"
                        IsEditable="True"
                        ItemsSource="{Binding AvailableProducts}"
                        SelectedItem="{Binding SelectedProduct}" />
                </Border>
            </Grid>

            <!--  Tugmalar  -->
            <StackPanel
                Grid.Column="2"
                Margin="20,5,10,0"
                Orientation="Vertical">
                <Button x:Name="btnPreview"
                    Height="29"
                    Margin="0,3"
                    md:ButtonAssist.CornerRadius="4"
                    Background="#1976D2"
                    BorderThickness="0"
                    Command="{Binding PreviewCommand}"
                    Content="Ko‘rish"
                    Foreground="White" />
                <Button x:Name="btnClear"
                    Height="29"
                    Margin="0,3"
                    md:ButtonAssist.CornerRadius="4"
                    Background="#3949AB"
                    BorderThickness="0"
                    Command="{Binding ClearFilterCommand}"
                    Content="Tozalash"
                    Foreground="White" />
            </StackPanel>
            <StackPanel
                Grid.Column="3"
                Margin="0,5"
                Orientation="Vertical">
                <Button x:Name="btnPrint"
                    Height="29"
                    Margin="0,3"
                    md:ButtonAssist.CornerRadius="4"
                    Background="#00897B"
                    BorderThickness="0"
                    Command="{Binding PrintCommand}"
                    Content="Pechat"
                    Foreground="White" />
                <Button x:Name="btnExport"
                    Height="29"
                    Margin="0,3"
                    md:ButtonAssist.CornerRadius="4"
                    Background="#2E7D32"
                    BorderThickness="0"
                    Command="{Binding ExportToExcelCommand}"
                    Content="Excel"
                    Foreground="White" />
            </StackPanel>
        </Grid>

        <!--  DataGrid — SEN HOZIRGI USTUNLARING TO‘LIQ!  -->
        <DataGrid
            Grid.Row="1"
            Margin="10,5"
            AlternatingRowBackground="#F8F9FA"
            AutoGenerateColumns="False"
            BorderBrush="#DDDDDD"
            BorderThickness="1"
            FontSize="14"
            GridLinesVisibility="All"
            HeadersVisibility="Column"
            IsReadOnly="True"
            ItemsSource="{Binding FilteredItems}"
            RowBackground="White"
            RowHeaderWidth="0">

            <DataGrid.Columns>



                <DataGridTemplateColumn Width="60" Header="T/r">

                    <DataGridTemplateColumn.HeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                        </Style>
                    </DataGridTemplateColumn.HeaderStyle>

                    <DataGridTemplateColumn.CellStyle>
                        <Style TargetType="DataGridCell">
                            <Setter Property="HorizontalAlignment" Value="Stretch" />
                            <Setter Property="VerticalContentAlignment" Value="Center" />
                        </Style>
                    </DataGridTemplateColumn.CellStyle>

                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock
                                HorizontalAlignment="Center"
                                VerticalAlignment="Center"
                                Text="{Binding RelativeSource={RelativeSource FindAncestor, AncestorType={x:Type DataGridRow}}, Converter={StaticResource IndexConverter}}" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>

                </DataGridTemplateColumn>
                <!--  1. Sana — O‘rtada (header + qiymat)  -->
                <DataGridTextColumn
                    Width="0.8*"
                    Binding="{Binding Date, StringFormat=dd.MM.yyyy}"
                    Header="Sana">
                    <DataGridTextColumn.HeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                        </Style>
                    </DataGridTextColumn.HeaderStyle>
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Center" />
                            <Setter Property="VerticalAlignment" Value="Center" />
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!--  2. Mijoz — Chapda  -->
                <DataGridTextColumn
                    Width="1.5*"
                    Binding="{Binding Customer}"
                    Header="Mijoz">
                    <DataGridTextColumn.HeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                        </Style>
                    </DataGridTextColumn.HeaderStyle>
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Left" />
                            <Setter Property="Margin" Value="8,0,0,0" />
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!--  3. Kodi — O‘rtada  -->
                <DataGridTextColumn
                    Width="0.6*"
                    Binding="{Binding Code}"
                    Header="Kodi">
                    <DataGridTextColumn.HeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                        </Style>
                    </DataGridTextColumn.HeaderStyle>
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Center" />
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!--  4. Nomi — Chapda  -->
                <DataGridTextColumn
                    Width="*"
                    Binding="{Binding ProductName}"
                    Header="Nomi">
                    <DataGridTextColumn.HeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                        </Style>
                    </DataGridTextColumn.HeaderStyle>
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Left" />
                            <Setter Property="Margin" Value="8,0,0,0" />
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!--  5. Razmer — O‘rtada  -->
                <DataGridTextColumn
                    Width="100"
                    Binding="{Binding Type}"
                    Header="Razmer">
                    <DataGridTextColumn.HeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                        </Style>
                    </DataGridTextColumn.HeaderStyle>
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Center" />
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!--  6. Qop soni — O‘rtada  -->
                <DataGridTextColumn
                    Width="0.8*"
                    Binding="{Binding BundleCount, StringFormat=N0}"
                    Header="Qop soni">
                    <DataGridTextColumn.HeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                        </Style>
                    </DataGridTextColumn.HeaderStyle>
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Center" />
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!--  6. Qopdagi soni — O‘rtada  -->
                <DataGridTextColumn
                    Width="0.8*"
                    Binding="{Binding BundleItemCount, StringFormat=N0}"
                    Header="Donasi">
                    <DataGridTextColumn.HeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                        </Style>
                    </DataGridTextColumn.HeaderStyle>
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Center" />
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!--  7. Jami — O‘ngda  -->
                <DataGridTextColumn
                    Width="*"
                    Binding="{Binding TotalCount, StringFormat=N0}"
                    Header="Jami">
                    <DataGridTextColumn.HeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                        </Style>
                    </DataGridTextColumn.HeaderStyle>
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right" />
                            <Setter Property="Margin" Value="0,0,8,0" />
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!--  8. O‘lchov — O‘rtada  -->
                <DataGridTextColumn
                    Width="0.7*"
                    Binding="{Binding UnitMeasure}"
                    Header="O‘lchov">
                    <DataGridTextColumn.HeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                        </Style>
                    </DataGridTextColumn.HeaderStyle>
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Center" />
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!--  9. Narxi — O‘ngda  -->
                <DataGridTextColumn
                    Width="*"
                    Binding="{Binding UnitPrice, StringFormat=N2}"
                    Header="Narxi">
                    <DataGridTextColumn.HeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                        </Style>
                    </DataGridTextColumn.HeaderStyle>
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right" />
                            <Setter Property="Margin" Value="0,0,8,0" />
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>

                <!--  10. Umumiy summa — O‘ngda  -->
                <DataGridTextColumn
                    Width="*"
                    Binding="{Binding Amount, StringFormat=N2}"
                    Header="Umumiy summa">
                    <DataGridTextColumn.HeaderStyle>
                        <Style TargetType="DataGridColumnHeader">
                            <Setter Property="HorizontalContentAlignment" Value="Center" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                        </Style>
                    </DataGridTextColumn.HeaderStyle>
                    <DataGridTextColumn.ElementStyle>
                        <Style TargetType="TextBlock">
                            <Setter Property="HorizontalAlignment" Value="Right" />
                            <Setter Property="Margin" Value="0,0,10,0" />
                            <Setter Property="FontWeight" Value="SemiBold" />
                            <Setter Property="Foreground" Value="#FF1976D2" />
                        </Style>
                    </DataGridTextColumn.ElementStyle>
                </DataGridTextColumn>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</UserControl>